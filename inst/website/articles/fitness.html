<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculating fitness • plant</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Calculating fitness">
<meta property="og:description" content="plant">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plant</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/plant.html">
    <span class="fas fa-tree"></span>
     
    Getting Started
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-list"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Theory
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/demography.html">Demography of plants, patches, and metacommunities</a>
    </li>
    <li>
      <a href="../articles/physiology.html">The FF16 strategy</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file-code-o"></span>
     
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/individuals.html">Individual plants</a>
    </li>
    <li>
      <a href="../articles/patch.html">Patches of competing plants</a>
    </li>
    <li>
      <a href="../articles/equilibrium.html">Finding demographic equilibrium</a>
    </li>
    <li>
      <a href="../articles/emergent.html">Emergent properties of patches</a>
    </li>
    <li>
      <a href="../articles/fitness.html">Calculating fitness</a>
    </li>
    <li>
      <a href="../articles/cohort_spacing.html">The cohort spacing algorithm</a>
    </li>
    <li>
      <a href="../articles/parameters.html">Changing parameters</a>
    </li>
    <li>
      <a href="../articles/strategy.html">Implementing a new strategy</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/developer_notes.html">
    <span class="fas fa-terminal"></span>
     
    Developer Notes
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/traitecoevo/plant">
    <span class="fas fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculating fitness</h1>
                        <h4 class="author">Rich FitzJohn</h4>
                        <h4 class="author">Daniel Falster</h4>
            
            <h4 class="date">2016</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/traitecoevo/plant/blob/master/vignettes/fitness.Rmd"><code>vignettes/fitness.Rmd</code></a></small>
      <div class="hidden name"><code>fitness.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h1>
<!-- TODO: movtivate fitness calculations -->
<p>Start by setting a few parameters; this is the base set of parameters we’ll use.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/traitecoevo/plant">plant</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span>
<span class="va">n_cores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scm_base_parameters.html">scm_base_parameters</a></span><span class="op">(</span><span class="st">"FF16"</span><span class="op">)</span>
<span class="va">params</span><span class="op">$</span><span class="va">control</span><span class="op">$</span><span class="va">equilibrium_solver_name</span> <span class="op">&lt;-</span> <span class="st">"hybrid"</span></code></pre></div>
</div>
<div id="fitness-landscape" class="section level1">
<h1 class="hasAnchor">
<a href="#fitness-landscape" class="anchor"></a>Fitness landscape</h1>
<!-- TODO: describe what `viable_fitness` is doing -->
<p>First, compute the space that any strategy can exist along the leaf mass area (LMA) axis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bounds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/viable_fitness.html">viable_fitness</a></span><span class="op">(</span><span class="fu"><a href="../reference/bounds.html">bounds_infinite</a></span><span class="op">(</span><span class="st">"lma"</span><span class="op">)</span>, <span class="va">params</span><span class="op">)</span>
<span class="va">bounds</span></code></pre></div>
<pre><code>##          lower    upper
## lma 0.02533822 4.989169</code></pre>
<p>Generate a set of trait values across this range and compute the fitness landscape:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trait_matrix.html">trait_matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/seq_log.html">seq_log_range</a></span><span class="op">(</span><span class="va">bounds</span>, <span class="fl">101</span><span class="op">)</span>, <span class="st">"lma"</span><span class="op">)</span>
<span class="va">fitness</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">params</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness</span>, type<span class="op">=</span><span class="st">"l"</span>, log<span class="op">=</span><span class="st">"x"</span>, las<span class="op">=</span><span class="fl">1</span>, ylab<span class="op">=</span><span class="st">"Fitness (empty environment)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-3-1.png"></p>
</div>
<div id="simulating-arrivals" class="section level1">
<h1 class="hasAnchor">
<a href="#simulating-arrivals" class="anchor"></a>Simulating arrivals</h1>
<p>Any trait value along this point can persist, so start with random sample:</p>
<!-- Fixing points for reproducibility -->
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lma_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.062</span>, <span class="fl">0.117</span>, <span class="fl">0.970</span>, <span class="fl">2.79</span><span class="op">)</span></code></pre></div>
<p>This function takes an LMA value, introduces it to the community, runs that out to equilibrium seed rain. If run interactively it will produce a lot of output:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">add_eq</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_parameters.html">expand_parameters</a></span><span class="op">(</span><span class="fu"><a href="../reference/trait_matrix.html">trait_matrix</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"lma"</span><span class="op">)</span>, <span class="va">p</span>, mutant<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="../reference/equilibrium_seed_rain.html">equilibrium_seed_rain</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">patches_eq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html">mclapply</a></span><span class="op">(</span><span class="va">lma_sample</span>, <span class="va">add_eq</span>, <span class="va">params</span>, mc.cores <span class="op">=</span> <span class="va">n_cores</span><span class="op">)</span></code></pre></div>
<p>Then compute fitness landscapes for each of these:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitness_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html">mclapply</a></span><span class="op">(</span><span class="va">patches_eq</span>, 
                           <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">lma</span><span class="op">)</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">p</span><span class="op">)</span>, 
                           <span class="va">lma</span>, mc.cores <span class="op">=</span> <span class="va">n_cores</span><span class="op">)</span>
<span class="va">fitness_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="va">fitness_sample</span><span class="op">)</span>
             
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_sample</span>, lty<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">"l"</span>, 
        log<span class="op">=</span><span class="st">"x"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">fitness_sample</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_sample</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-6-1.png"></p>
<p>For this system, there is an evolutionary attractor around LMA values of 0.0825:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lma_attr</span> <span class="op">&lt;-</span> <span class="fl">0.0825</span>
<span class="va">patch_eq_attr</span> <span class="op">&lt;-</span> <span class="fu">add_eq</span><span class="op">(</span><span class="va">lma_attr</span>, <span class="va">params</span><span class="op">)</span></code></pre></div>
<pre><code>## [2021-02-25 12:22:37.182] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:22:37.182] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:22:39.387] schedule&gt; 1: Splitting {20} times (141)
## [2021-02-25 12:22:39.387] schedule&gt; 1: Splitting {20} times (141)
## [2021-02-25 12:22:41.755] schedule&gt; 2: Splitting {9} times (161)
## [2021-02-25 12:22:41.755] schedule&gt; 2: Splitting {9} times (161)
## [2021-02-25 12:22:44.277] equilibrium&gt; eq&gt; 1: {1} -&gt; {19.97185} (delta = {18.97185})
## [2021-02-25 12:22:44.277] equilibrium&gt; eq&gt; 1: {1} -&gt; {19.97185} (delta = {18.97185})
## [2021-02-25 12:22:48.013] schedule&gt; 1: Splitting {34} times (141)
## [2021-02-25 12:22:48.013] schedule&gt; 1: Splitting {34} times (141)
## [2021-02-25 12:22:52.780] schedule&gt; 2: Splitting {27} times (175)
## [2021-02-25 12:22:52.780] schedule&gt; 2: Splitting {27} times (175)
## [2021-02-25 12:22:58.469] schedule&gt; 3: Splitting {9} times (202)
## [2021-02-25 12:22:58.469] schedule&gt; 3: Splitting {9} times (202)
## [2021-02-25 12:23:04.018] schedule&gt; 4: Splitting {1} times (211)
## [2021-02-25 12:23:04.018] schedule&gt; 4: Splitting {1} times (211)
## [2021-02-25 12:23:09.563] equilibrium&gt; eq&gt; 2: {19.97185} -&gt; {17.15125} (delta = {-2.820598})
## [2021-02-25 12:23:09.563] equilibrium&gt; eq&gt; 2: {19.97185} -&gt; {17.15125} (delta = {-2.820598})
## [2021-02-25 12:23:15.811] schedule&gt; 1: Splitting {1} times (212)
## [2021-02-25 12:23:15.811] schedule&gt; 1: Splitting {1} times (212)
## [2021-02-25 12:23:22.050] equilibrium&gt; eq&gt; 3: {17.15125} -&gt; {17.31508} (delta = {0.1638286})
## [2021-02-25 12:23:22.050] equilibrium&gt; eq&gt; 3: {17.15125} -&gt; {17.31508} (delta = {0.1638286})
## [2021-02-25 12:23:28.317] equilibrium&gt; eq&gt; 4: {17.31508} -&gt; {17.30373} (delta = {-0.01134973})
## [2021-02-25 12:23:28.317] equilibrium&gt; eq&gt; 4: {17.31508} -&gt; {17.30373} (delta = {-0.01134973})
## [2021-02-25 12:23:28.317] equilibrium&gt; Reached target accuracy (delta 1.13497e-02, 6.55482e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:23:28.317] equilibrium&gt; Reached target accuracy (delta 1.13497e-02, 6.55482e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:23:28.318] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:23:28.318] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:23:28.318] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:23:28.318] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:23:32.107] schedule&gt; 1: Splitting {38} times (141)
## [2021-02-25 12:23:32.107] schedule&gt; 1: Splitting {38} times (141)
## [2021-02-25 12:23:37.236] schedule&gt; 2: Splitting {22} times (179)
## [2021-02-25 12:23:37.236] schedule&gt; 2: Splitting {22} times (179)
## [2021-02-25 12:23:42.919] schedule&gt; 3: Splitting {11} times (201)
## [2021-02-25 12:23:42.919] schedule&gt; 3: Splitting {11} times (201)
## [2021-02-25 12:23:49.171] schedule&gt; 4: Splitting {1} times (212)
## [2021-02-25 12:23:49.171] schedule&gt; 4: Splitting {1} times (212)
## [2021-02-25 12:23:55.448] equilibrium&gt; eq&gt; 1: {17.31508} -&gt; {17.30575} (delta = {-0.009332469})
## [2021-02-25 12:23:55.448] equilibrium&gt; eq&gt; 1: {17.31508} -&gt; {17.30575} (delta = {-0.009332469})
## [2021-02-25 12:23:55.449] equilibrium&gt; Keeping species 
## [2021-02-25 12:23:55.449] equilibrium&gt; Keeping species 
## [2021-02-25 12:24:01.719] equilibrium&gt; eq&gt; 2: {17.31508} -&gt; {17.30575} (delta = {-0.00933248})
## [2021-02-25 12:24:01.719] equilibrium&gt; eq&gt; 2: {17.31508} -&gt; {17.30575} (delta = {-0.00933248})
## [2021-02-25 12:24:07.997] equilibrium&gt; eq&gt; 3: {17.31508} -&gt; {17.30575} (delta = {-0.00933248})
## [2021-02-25 12:24:07.997] equilibrium&gt; eq&gt; 3: {17.31508} -&gt; {17.30575} (delta = {-0.00933248})
## [2021-02-25 12:24:14.301] equilibrium&gt; eq&gt; 4: {17.31508} -&gt; {17.30575} (delta = {-0.009333543})
## [2021-02-25 12:24:14.301] equilibrium&gt; eq&gt; 4: {17.31508} -&gt; {17.30575} (delta = {-0.009333543})
## [2021-02-25 12:24:20.375] equilibrium&gt; eq&gt; 5: {17.30636} -&gt; {17.30628} (delta = {-8.162057e-05})
## [2021-02-25 12:24:20.375] equilibrium&gt; eq&gt; 5: {17.30636} -&gt; {17.30628} (delta = {-8.162057e-05})
## [2021-02-25 12:24:20.375] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:24:20.375] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:24:20.376] equilibrium&gt; Accepting solution via solver
## [2021-02-25 12:24:20.376] equilibrium&gt; Accepting solution via solver</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitness_attr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">patch_eq_attr</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_attr</span>, log<span class="op">=</span><span class="st">"x"</span>, type<span class="op">=</span><span class="st">"l"</span>, las<span class="op">=</span><span class="fl">1</span>,
     xlab<span class="op">=</span><span class="st">"Leaf mass per unit leaf area"</span>, ylab<span class="op">=</span><span class="st">"Fitness"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_attr</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-7-1.png"></p>
<p>Zooming in in the vicinity of the result shows that this is disruptive selection: fitness increases to both sides of the resident!</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lma_detail</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trait_matrix.html">trait_matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/seq_log.html">seq_log</a></span><span class="op">(</span><span class="va">lma_attr</span> <span class="op">*</span> <span class="fl">0.95</span>, <span class="va">lma_attr</span> <span class="op">*</span> <span class="fl">1.05</span>, <span class="fl">51</span><span class="op">)</span>, <span class="st">"lma"</span><span class="op">)</span>
<span class="va">fitness_detail</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma_detail</span>, <span class="va">patch_eq_attr</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma_detail</span>, <span class="va">fitness_detail</span>, log<span class="op">=</span><span class="st">"x"</span>, type<span class="op">=</span><span class="st">"l"</span>, las<span class="op">=</span><span class="fl">1</span>,
     xlab<span class="op">=</span><span class="st">"Leaf mass per unit leaf area"</span>, ylab<span class="op">=</span><span class="st">"Fitness"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_attr</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-8-1.png"></p>
</div>
<div id="invasion-landscapes" class="section level1">
<h1 class="hasAnchor">
<a href="#invasion-landscapes" class="anchor"></a>Invasion landscapes</h1>
<p>Holding the first species at 0.0825 we can introduce additional species (it’s close enough to the optimum here, though in general this point might move substantially as new species are introduced).</p>
<p>Consider the point of maximum fitness:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lma_max</span> <span class="op">&lt;-</span> <span class="va">lma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">fitness_attr</span><span class="op">)</span><span class="op">]</span>
<span class="va">lma_max</span></code></pre></div>
<pre><code>## [1] 0.3748389</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_attr</span>, log<span class="op">=</span><span class="st">"x"</span>, type<span class="op">=</span><span class="st">"l"</span>, las<span class="op">=</span><span class="fl">1</span>,
     xlab<span class="op">=</span><span class="st">"Leaf mass per unit leaf area"</span>, ylab<span class="op">=</span><span class="st">"Fitness"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_attr</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">lma_max</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-9-1.png"></p>
<p>Introducing a new species the point of maximum fitness <em>draws the fitness landscape down</em> around the second species, with a fitness gradient that points towards increased LMA.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">patch_eq_max</span> <span class="op">&lt;-</span> <span class="fu">add_eq</span><span class="op">(</span><span class="va">lma_max</span>, <span class="va">patch_eq_attr</span><span class="op">)</span></code></pre></div>
<pre><code>## [2021-02-25 12:32:25.755] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:32:25.755] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:32:34.520] schedule&gt; 1: Splitting {0,21} times (213,141)
## [2021-02-25 12:32:34.520] schedule&gt; 1: Splitting {0,21} times (213,141)
## [2021-02-25 12:32:43.749] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.22391, 17.26106} (delta = {-5.08245, 16.26106})
## [2021-02-25 12:32:43.749] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.22391, 17.26106} (delta = {-5.08245, 16.26106})
## [2021-02-25 12:32:52.296] schedule&gt; 1: Splitting {15,14} times (141,141)
## [2021-02-25 12:32:52.296] schedule&gt; 1: Splitting {15,14} times (141,141)
## [2021-02-25 12:33:02.664] schedule&gt; 2: Splitting {2,4} times (156,155)
## [2021-02-25 12:33:02.664] schedule&gt; 2: Splitting {2,4} times (156,155)
## [2021-02-25 12:33:13.237] equilibrium&gt; eq&gt; 2: {12.22391, 17.26106} -&gt; {12.86662, 14.95559} (delta = {0.6427081, -2.305471})
## [2021-02-25 12:33:13.237] equilibrium&gt; eq&gt; 2: {12.22391, 17.26106} -&gt; {12.86662, 14.95559} (delta = {0.6427081, -2.305471})
## [2021-02-25 12:33:23.467] equilibrium&gt; eq&gt; 3: {12.86662, 14.95559} -&gt; {12.82323, 15.022} (delta = {-0.04338479, 0.06640538})
## [2021-02-25 12:33:23.467] equilibrium&gt; eq&gt; 3: {12.86662, 14.95559} -&gt; {12.82323, 15.022} (delta = {-0.04338479, 0.06640538})
## [2021-02-25 12:33:33.954] equilibrium&gt; eq&gt; 4: {12.82323, 15.022} -&gt; {12.82532, 15.02144} (delta = {0.002088111, -0.0005603039})
## [2021-02-25 12:33:33.954] equilibrium&gt; eq&gt; 4: {12.82323, 15.022} -&gt; {12.82532, 15.02144} (delta = {0.002088111, -0.0005603039})
## [2021-02-25 12:33:33.955] equilibrium&gt; Reached target accuracy (delta 2.08811e-03, 1.62838e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:33:33.955] equilibrium&gt; Reached target accuracy (delta 2.08811e-03, 1.62838e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:33:33.955] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:33:33.955] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:33:33.955] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:33:33.955] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:33:46.043] schedule&gt; 1: Splitting {0,14} times (213,141)
## [2021-02-25 12:33:46.043] schedule&gt; 1: Splitting {0,14} times (213,141)
## [2021-02-25 12:33:57.421] schedule&gt; 2: Splitting {0,4} times (213,155)
## [2021-02-25 12:33:57.421] schedule&gt; 2: Splitting {0,4} times (213,155)
## [2021-02-25 12:34:09.462] equilibrium&gt; eq&gt; 1: {12.82323, 15.022} -&gt; {12.83544, 15.02179} (delta = {0.01220595, -0.0002059787})
## [2021-02-25 12:34:09.462] equilibrium&gt; eq&gt; 1: {12.82323, 15.022} -&gt; {12.83544, 15.02179} (delta = {0.01220595, -0.0002059787})
## [2021-02-25 12:34:09.462] equilibrium&gt; Keeping species 1
## [2021-02-25 12:34:09.462] equilibrium&gt; Keeping species 1
## [2021-02-25 12:34:21.498] equilibrium&gt; eq&gt; 2: {12.82323, 15.022} -&gt; {12.83544, 15.02179} (delta = {0.01220593, -0.0002059979})
## [2021-02-25 12:34:21.498] equilibrium&gt; eq&gt; 2: {12.82323, 15.022} -&gt; {12.83544, 15.02179} (delta = {0.01220593, -0.0002059979})
## [2021-02-25 12:34:33.541] equilibrium&gt; eq&gt; 3: {12.82323, 15.022} -&gt; {12.83544, 15.02179} (delta = {0.01220593, -0.0002059979})
## [2021-02-25 12:34:33.541] equilibrium&gt; eq&gt; 3: {12.82323, 15.022} -&gt; {12.83544, 15.02179} (delta = {0.01220593, -0.0002059979})
## [2021-02-25 12:34:33.542] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:34:33.542] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:34:33.542] equilibrium&gt; Accepting solution via solver
## [2021-02-25 12:34:33.542] equilibrium&gt; Accepting solution via solver</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitness_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">patch_eq_max</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_attr</span>, log<span class="op">=</span><span class="st">"x"</span>, type<span class="op">=</span><span class="st">"l"</span>, las<span class="op">=</span><span class="fl">1</span>,
     xlab<span class="op">=</span><span class="st">"Leaf mass per unit leaf area"</span>, ylab<span class="op">=</span><span class="st">"Fitness"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_attr</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>
<span class="va">lma_max_2</span> <span class="op">&lt;-</span> <span class="va">lma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">fitness_max</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">lma_max_2</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-10-1.png"></p>
<p>At the cost of extremely tedious copy/paste code, here is the result of repeatedly taking the lma value with highest fitness and moving the second species to this point, running to equilibrium, and plotting. For comparison the previous landscapes are retained as dotted lines.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">patch_eq_max_2</span> <span class="op">&lt;-</span> <span class="fu">add_eq</span><span class="op">(</span><span class="va">lma_max_2</span>, <span class="va">patch_eq_attr</span><span class="op">)</span></code></pre></div>
<pre><code>## [2021-02-25 12:40:48.937] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:40:48.937] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:40:58.025] schedule&gt; 1: Splitting {0,23} times (213,141)
## [2021-02-25 12:40:58.025] schedule&gt; 1: Splitting {0,23} times (213,141)
## [2021-02-25 12:41:07.483] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.01292, 17.08176} (delta = {-5.293438, 16.08176})
## [2021-02-25 12:41:07.483] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.01292, 17.08176} (delta = {-5.293438, 16.08176})
## [2021-02-25 12:41:15.117] schedule&gt; 1: Splitting {15,17} times (141,141)
## [2021-02-25 12:41:15.117] schedule&gt; 1: Splitting {15,17} times (141,141)
## [2021-02-25 12:41:23.755] schedule&gt; 2: Splitting {3,2} times (156,158)
## [2021-02-25 12:41:23.755] schedule&gt; 2: Splitting {3,2} times (156,158)
## [2021-02-25 12:41:32.830] equilibrium&gt; eq&gt; 2: {12.01292, 17.08176} -&gt; {12.36448, 15.79908} (delta = {0.3515555, -1.282681})
## [2021-02-25 12:41:32.830] equilibrium&gt; eq&gt; 2: {12.01292, 17.08176} -&gt; {12.36448, 15.79908} (delta = {0.3515555, -1.282681})
## [2021-02-25 12:41:42.435] equilibrium&gt; eq&gt; 3: {12.36448, 15.79908} -&gt; {12.34319, 15.84398} (delta = {-0.02128601, 0.0448966})
## [2021-02-25 12:41:42.435] equilibrium&gt; eq&gt; 3: {12.36448, 15.79908} -&gt; {12.34319, 15.84398} (delta = {-0.02128601, 0.0448966})
## [2021-02-25 12:41:52.109] equilibrium&gt; eq&gt; 4: {12.34319, 15.84398} -&gt; {12.34414, 15.84312} (delta = {0.0009458628, -0.0008565372})
## [2021-02-25 12:41:52.109] equilibrium&gt; eq&gt; 4: {12.34319, 15.84398} -&gt; {12.34414, 15.84312} (delta = {0.0009458628, -0.0008565372})
## [2021-02-25 12:41:52.110] equilibrium&gt; Reached target accuracy (delta 9.45863e-04, 7.66303e-05 &lt; 1.00000e-03 eps)
## [2021-02-25 12:41:52.110] equilibrium&gt; Reached target accuracy (delta 9.45863e-04, 7.66303e-05 &lt; 1.00000e-03 eps)
## [2021-02-25 12:41:52.110] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:41:52.110] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:41:52.111] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:41:52.111] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:42:03.437] schedule&gt; 1: Splitting {1,17} times (213,141)
## [2021-02-25 12:42:03.437] schedule&gt; 1: Splitting {1,17} times (213,141)
## [2021-02-25 12:42:14.530] schedule&gt; 2: Splitting {0,2} times (214,158)
## [2021-02-25 12:42:14.530] schedule&gt; 2: Splitting {0,2} times (214,158)
## [2021-02-25 12:42:25.702] equilibrium&gt; eq&gt; 1: {12.34319, 15.84398} -&gt; {12.35551, 15.85483} (delta = {0.01231563, 0.01084816})
## [2021-02-25 12:42:25.702] equilibrium&gt; eq&gt; 1: {12.34319, 15.84398} -&gt; {12.35551, 15.85483} (delta = {0.01231563, 0.01084816})
## [2021-02-25 12:42:25.703] equilibrium&gt; Keeping species 1, 2
## [2021-02-25 12:42:25.703] equilibrium&gt; Keeping species 1, 2
## [2021-02-25 12:42:36.877] equilibrium&gt; eq&gt; 2: {12.34319, 15.84398} -&gt; {12.35551, 15.85483} (delta = {0.01231563, 0.01084813})
## [2021-02-25 12:42:36.877] equilibrium&gt; eq&gt; 2: {12.34319, 15.84398} -&gt; {12.35551, 15.85483} (delta = {0.01231563, 0.01084813})
## [2021-02-25 12:42:47.979] equilibrium&gt; eq&gt; 3: {12.34319, 15.84398} -&gt; {12.35551, 15.85483} (delta = {0.01231563, 0.01084813})
## [2021-02-25 12:42:47.979] equilibrium&gt; eq&gt; 3: {12.34319, 15.84398} -&gt; {12.35551, 15.85483} (delta = {0.01231563, 0.01084813})
## [2021-02-25 12:42:47.980] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:42:47.980] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:42:47.980] equilibrium&gt; Accepting solution via solver
## [2021-02-25 12:42:47.980] equilibrium&gt; Accepting solution via solver</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitness_max_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">patch_eq_max_2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_attr</span>, log<span class="op">=</span><span class="st">"x"</span>, type<span class="op">=</span><span class="st">"l"</span>, las<span class="op">=</span><span class="fl">1</span>,
     xlab<span class="op">=</span><span class="st">"Leaf mass per unit leaf area"</span>, ylab<span class="op">=</span><span class="st">"Fitness"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max_2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_attr</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max</span>, <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max_2</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>
<span class="va">lma_max_3</span> <span class="op">&lt;-</span> <span class="va">lma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">fitness_max_2</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">lma_max_3</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-11-1.png"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">patch_eq_max_3</span> <span class="op">&lt;-</span> <span class="fu">add_eq</span><span class="op">(</span><span class="va">lma_max_3</span>, <span class="va">patch_eq_attr</span><span class="op">)</span></code></pre></div>
<pre><code>## [2021-02-25 12:48:42.903] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:48:42.903] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:48:52.594] schedule&gt; 1: Splitting {0,20} times (213,141)
## [2021-02-25 12:48:52.594] schedule&gt; 1: Splitting {0,20} times (213,141)
## [2021-02-25 12:49:02.534] schedule&gt; 2: Splitting {0,2} times (213,161)
## [2021-02-25 12:49:02.534] schedule&gt; 2: Splitting {0,2} times (213,161)
## [2021-02-25 12:49:12.230] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.01147, 16.52161} (delta = {-5.294885, 15.52161})
## [2021-02-25 12:49:12.230] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.01147, 16.52161} (delta = {-5.294885, 15.52161})
## [2021-02-25 12:49:19.969] schedule&gt; 1: Splitting {15,21} times (141,141)
## [2021-02-25 12:49:19.969] schedule&gt; 1: Splitting {15,21} times (141,141)
## [2021-02-25 12:49:29.683] schedule&gt; 2: Splitting {4,1} times (156,162)
## [2021-02-25 12:49:29.683] schedule&gt; 2: Splitting {4,1} times (156,162)
## [2021-02-25 12:49:39.441] equilibrium&gt; eq&gt; 2: {12.01147, 16.52161} -&gt; {12.08184, 16.30608} (delta = {0.07036873, -0.215529})
## [2021-02-25 12:49:39.441] equilibrium&gt; eq&gt; 2: {12.01147, 16.52161} -&gt; {12.08184, 16.30608} (delta = {0.07036873, -0.215529})
## [2021-02-25 12:49:49.344] equilibrium&gt; eq&gt; 3: {12.08184, 16.30608} -&gt; {12.08062, 16.30764} (delta = {-0.001220601, 0.00156395})
## [2021-02-25 12:49:49.344] equilibrium&gt; eq&gt; 3: {12.08184, 16.30608} -&gt; {12.08062, 16.30764} (delta = {-0.001220601, 0.00156395})
## [2021-02-25 12:49:49.345] equilibrium&gt; Reached target accuracy (delta 1.56395e-03, 1.01028e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:49:49.345] equilibrium&gt; Reached target accuracy (delta 1.56395e-03, 1.01028e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:49:49.345] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:49:49.345] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:49:49.346] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:49:49.346] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:50:01.017] schedule&gt; 1: Splitting {0,19} times (213,141)
## [2021-02-25 12:50:01.017] schedule&gt; 1: Splitting {0,19} times (213,141)
## [2021-02-25 12:50:12.328] schedule&gt; 2: Splitting {0,1} times (213,160)
## [2021-02-25 12:50:12.328] schedule&gt; 2: Splitting {0,1} times (213,160)
## [2021-02-25 12:50:23.827] equilibrium&gt; eq&gt; 1: {12.08184, 16.30608} -&gt; {12.09272, 16.3084} (delta = {0.01087391, 0.002320391})
## [2021-02-25 12:50:23.827] equilibrium&gt; eq&gt; 1: {12.08184, 16.30608} -&gt; {12.09272, 16.3084} (delta = {0.01087391, 0.002320391})
## [2021-02-25 12:50:23.828] equilibrium&gt; Keeping species 1, 2
## [2021-02-25 12:50:23.828] equilibrium&gt; Keeping species 1, 2
## [2021-02-25 12:50:35.349] equilibrium&gt; eq&gt; 2: {12.08184, 16.30608} -&gt; {12.09272, 16.3084} (delta = {0.0108739, 0.002320425})
## [2021-02-25 12:50:35.349] equilibrium&gt; eq&gt; 2: {12.08184, 16.30608} -&gt; {12.09272, 16.3084} (delta = {0.0108739, 0.002320425})
## [2021-02-25 12:50:46.903] equilibrium&gt; eq&gt; 3: {12.08184, 16.30608} -&gt; {12.09272, 16.3084} (delta = {0.0108739, 0.002320425})
## [2021-02-25 12:50:46.903] equilibrium&gt; eq&gt; 3: {12.08184, 16.30608} -&gt; {12.09272, 16.3084} (delta = {0.0108739, 0.002320425})
## [2021-02-25 12:50:46.904] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:50:46.904] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:50:46.904] equilibrium&gt; Accepting solution via solver
## [2021-02-25 12:50:46.904] equilibrium&gt; Accepting solution via solver</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitness_max_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">patch_eq_max_3</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_attr</span>, log<span class="op">=</span><span class="st">"x"</span>, type<span class="op">=</span><span class="st">"l"</span>, las<span class="op">=</span><span class="fl">1</span>,
     xlab<span class="op">=</span><span class="st">"Leaf mass per unit leaf area"</span>, ylab<span class="op">=</span><span class="st">"Fitness"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max_2</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max_3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_attr</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max</span>, <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max_2</span>, <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max_3</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>
<span class="va">lma_max_4</span> <span class="op">&lt;-</span> <span class="va">lma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">fitness_max_3</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">lma_max_4</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-11-2.png"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">patch_eq_max_4</span> <span class="op">&lt;-</span> <span class="fu">add_eq</span><span class="op">(</span><span class="va">lma_max_4</span>, <span class="va">patch_eq_attr</span><span class="op">)</span></code></pre></div>
<pre><code>## [2021-02-25 12:56:55.515] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:56:55.515] equilibrium&gt; Solving seed rain using hybrid
## [2021-02-25 12:57:04.967] schedule&gt; 1: Splitting {0,22} times (213,141)
## [2021-02-25 12:57:04.967] schedule&gt; 1: Splitting {0,22} times (213,141)
## [2021-02-25 12:57:14.460] schedule&gt; 2: Splitting {0,4} times (213,163)
## [2021-02-25 12:57:14.460] schedule&gt; 2: Splitting {0,4} times (213,163)
## [2021-02-25 12:57:24.430] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.03605, 16.1373} (delta = {-5.27031, 15.1373})
## [2021-02-25 12:57:24.430] equilibrium&gt; eq&gt; 1: {17.30636, 1} -&gt; {12.03605, 16.1373} (delta = {-5.27031, 15.1373})
## [2021-02-25 12:57:32.149] schedule&gt; 1: Splitting {16,21} times (141,141)
## [2021-02-25 12:57:32.149] schedule&gt; 1: Splitting {16,21} times (141,141)
## [2021-02-25 12:57:42.126] schedule&gt; 2: Splitting {4,1} times (157,162)
## [2021-02-25 12:57:42.126] schedule&gt; 2: Splitting {4,1} times (157,162)
## [2021-02-25 12:57:51.926] equilibrium&gt; eq&gt; 2: {12.03605, 16.1373} -&gt; {11.96548, 16.56598} (delta = {-0.07057156, 0.4286856})
## [2021-02-25 12:57:51.926] equilibrium&gt; eq&gt; 2: {12.03605, 16.1373} -&gt; {11.96548, 16.56598} (delta = {-0.07057156, 0.4286856})
## [2021-02-25 12:58:01.602] equilibrium&gt; eq&gt; 3: {11.96548, 16.56598} -&gt; {11.96313, 16.57663} (delta = {-0.002351885, 0.01064882})
## [2021-02-25 12:58:01.602] equilibrium&gt; eq&gt; 3: {11.96548, 16.56598} -&gt; {11.96313, 16.57663} (delta = {-0.002351885, 0.01064882})
## [2021-02-25 12:58:01.602] equilibrium&gt; Reached target accuracy (delta 1.06488e-02, 6.42812e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:58:01.602] equilibrium&gt; Reached target accuracy (delta 1.06488e-02, 6.42812e-04 &lt; 1.00000e-03 eps)
## [2021-02-25 12:58:01.603] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:58:01.603] equilibrium&gt; Iteration 1 converged
## [2021-02-25 12:58:01.603] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:58:01.603] equilibrium&gt; Solving seed rain using nleqslv
## [2021-02-25 12:58:12.815] schedule&gt; 1: Splitting {0,21} times (213,141)
## [2021-02-25 12:58:12.815] schedule&gt; 1: Splitting {0,21} times (213,141)
## [2021-02-25 12:58:24.253] schedule&gt; 2: Splitting {0,1} times (213,162)
## [2021-02-25 12:58:24.253] schedule&gt; 2: Splitting {0,1} times (213,162)
## [2021-02-25 12:58:35.709] equilibrium&gt; eq&gt; 1: {11.96548, 16.56598} -&gt; {11.97546, 16.57718} (delta = {0.009985282, 0.01119273})
## [2021-02-25 12:58:35.709] equilibrium&gt; eq&gt; 1: {11.96548, 16.56598} -&gt; {11.97546, 16.57718} (delta = {0.009985282, 0.01119273})
## [2021-02-25 12:58:35.709] equilibrium&gt; Keeping species 1, 2
## [2021-02-25 12:58:35.709] equilibrium&gt; Keeping species 1, 2
## [2021-02-25 12:58:47.172] equilibrium&gt; eq&gt; 2: {11.96548, 16.56598} -&gt; {11.97546, 16.57718} (delta = {0.009985294, 0.01119281})
## [2021-02-25 12:58:47.172] equilibrium&gt; eq&gt; 2: {11.96548, 16.56598} -&gt; {11.97546, 16.57718} (delta = {0.009985294, 0.01119281})
## [2021-02-25 12:58:58.640] equilibrium&gt; eq&gt; 3: {11.96548, 16.56598} -&gt; {11.97546, 16.57718} (delta = {0.009985294, 0.01119281})
## [2021-02-25 12:58:58.640] equilibrium&gt; eq&gt; 3: {11.96548, 16.56598} -&gt; {11.97546, 16.57718} (delta = {0.009985294, 0.01119281})
## [2021-02-25 12:58:58.640] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:58:58.640] equilibrium&gt; Solve 1 converged
## [2021-02-25 12:58:58.641] equilibrium&gt; Accepting solution via solver
## [2021-02-25 12:58:58.641] equilibrium&gt; Accepting solution via solver</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitness_max_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitness_landscape.html">fitness_landscape</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">patch_eq_max_4</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_attr</span>, log<span class="op">=</span><span class="st">"x"</span>, type<span class="op">=</span><span class="st">"l"</span>, las<span class="op">=</span><span class="fl">1</span>,
     xlab<span class="op">=</span><span class="st">"Leaf mass per unit leaf area"</span>, ylab<span class="op">=</span><span class="st">"Fitness"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max_2</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max_3</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lma</span>, <span class="va">fitness_max_4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_attr</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max</span>, <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max_2</span>, <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max_3</span>, <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">lma_max_4</span>, <span class="fl">0</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>

<span class="va">lma_max_5</span> <span class="op">&lt;-</span> <span class="va">lma</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">fitness_max_4</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">lma_max_5</span><span class="op">)</span></code></pre></div>
<p><img src="figure/fitness__unnamed-chunk-11-3.png"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Falster, Richard FitzJohn, Rafael Schouten, Andrew O'Reilly-Nugent.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
